<body>
  <h2>Scheduled YouTube Video Player</h2>

  <div id="next" style="font-weight:bold; margin-bottom:10px; color:darkblue;"></div>

  <!-- Install button -->
  <button id="installBtn" style="display:none; margin-bottom:15px;">ðŸ“² Install App</button>

  <!-- Hidden YouTube player -->
  <div id="player"></div>

  <!-- Debug log area -->
  <div id="log" style="margin-top:20px; font-family:monospace; white-space:pre; border:1px solid #ccc; padding:10px; height:200px; overflow-y:auto;"></div>

  <script src="https://www.youtube.com/iframe_api"></script>
  <script src="script.js"></script>
  <script>
    // Service Worker
    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("sw.js")
        .then(() => console.log("Service Worker registered"))
        .catch((err) => console.error("Service Worker failed:", err));
    }

    // Handle install prompt
    let deferredPrompt;
    const installBtn = document.getElementById("installBtn");

    window.addEventListener("beforeinstallprompt", (e) => {
      e.preventDefault(); // stop auto prompt
      deferredPrompt = e;
      installBtn.style.display = "inline-block"; // show button
    });

    installBtn.addEventListener("click", () => {
      if (deferredPrompt) {
        deferredPrompt.prompt();
        deferredPrompt.userChoice.then((choice) => {
          if (choice.outcome === "accepted") {
            console.log("User accepted install");
          } else {
            console.log("User dismissed install");
          }
          deferredPrompt = null;
          installBtn.style.display = "none"; // hide button
        });
      }
    });
  </script>
</body>
